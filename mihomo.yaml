#----------------------------------------------------------------#
#                    Mihomo é…ç½®æ–‡ä»¶ (æ›´æ–°ç‰ˆ)                     #
#        å·²æ ¹æ®æ‚¨çš„æ–°éœ€æ±‚è¿›è¡Œè°ƒæ•´ (DNSåˆ†ç¦», åŒè®¢é˜…, ç«¯å£)          #
#----------------------------------------------------------------#

# (1) åŸºç¡€è®¾ç½®
#----------------------------------------------------------------#
# æ··åˆç«¯å£ï¼ŒåŒæ—¶æ”¯æŒ HTTP å’Œ SOCKS5/SOCKS4 åè®®ï¼Œä¾›å†…ç½‘å…¶ä»–è®¾å¤‡ä½¿ç”¨
mixed-port: 7890
# å˜æ›´ç‚¹ 3ï¼šæ ¹æ®æ‚¨çš„éœ€æ±‚ï¼Œå°† API ç«¯å£ä¿®æ”¹ä¸º 9097
port: 9097
socks-port: 7891
# å·²å¼€å¯å±€åŸŸç½‘è¿æ¥
allow-lan: true
# ç»‘å®šåˆ° 0.0.0.0ï¼Œä»¥ä¾¿å±€åŸŸç½‘å†…æ‰€æœ‰è®¾å¤‡éƒ½å¯ä»¥è®¿é—®
bind-address: '*'
mode: rule
log-level: info
ipv6: true


# (2) å¤–éƒ¨æ§åˆ¶ä¸ UI ç•Œé¢
#----------------------------------------------------------------#
# å˜æ›´ç‚¹ 3ï¼šåŒæ­¥ä¿®æ”¹ external-controller çš„ç«¯å£ä¸º 9097
external-controller: '127.0.0.1:9097'
# è®¿é—®åœ°å€ç°åœ¨æ˜¯ï¼šhttp://<ä½ çš„ç”µè„‘IP>:9097/ui
external-ui: ui
external-ui-url: "https://github.com/MetaCubeX/yacd-meta/archive/gh-pages.zip"


# (3) DNS é…ç½®
#----------------------------------------------------------------#
# å˜æ›´ç‚¹ 1ï¼šæ ¹æ®æ‚¨çš„éœ€æ±‚ä¿®æ”¹ DNS è®¾ç½®
dns:
  enable: true
  listen: '0.0.0.0:1053'
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  # ç”¨äºè§£æç›´è¿åŸŸå (å›½å†…) çš„ DNS
  nameserver:
    - 10.10.8.8
    - 114.114.114.114
    - 223.5.5.5
  # ç”¨äºè§£æä»£ç†åŸŸå (å›½å¤–) çš„ DNS
  fallback:
    - https://8.8.8.8/dns-query
    - https://1.1.1.1/dns-query
  # ä»…éä¸­å›½å¤§é™†IPçš„åŸŸåæŸ¥è¯¢èµ° fallback DNSï¼Œé˜²æ­¢å›½å†…åŸŸåè¢«å›½å¤– DNS è§£æ
  fallback-filter: { geoip: true }
  proxy-server-dns: true


# (4) ä»£ç†èŠ‚ç‚¹è®¢é˜… (Proxy Providers)
#----------------------------------------------------------------#
# å˜æ›´ç‚¹ 2ï¼šæ·»åŠ ä¸¤ä¸ªè®¢é˜…é“¾æ¥
proxy-providers:
  # æ‚¨çš„ç¬¬ä¸€ä¸ªä¸»è®¢é˜…
  main_subscription:
    type: http
    # !!! å…³é”®ï¼šè¯·å°†ä¸‹é¢çš„ URL æ›¿æ¢ä¸ºæ‚¨çš„ç¬¬ä¸€ä¸ªè®¢é˜…é“¾æ¥ !!!
    url: "https://example.com/your-main-subscription-url"
    interval: 3600
    path: ./main_subscription.yaml
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300
  # æ‚¨çš„ç¬¬äºŒä¸ª Cloudflare ä¸“ç”¨è®¢é˜…
  cloudflare_subscription:
    type: http
    # !!! å…³é”®ï¼šè¯·å°†ä¸‹é¢çš„ URL æ›¿æ¢ä¸ºæ‚¨çš„ Cloudflare ä¸“ç”¨è®¢é˜…é“¾æ¥ !!!
    url: "https://example.com/your-cloudflare-subscription-url"
    interval: 3600
    path: ./cloudflare_subscription.yaml
    health-check:
      enable: true
      url: http://www.gstatic.com/generate_204
      interval: 300


# (5) ä»£ç†èŠ‚ç‚¹ (Proxies)
#----------------------------------------------------------------#
proxies:
  # é€šå¸¸è®¢é˜…åæ­¤å¤„ç•™ç©º


# (6) ä»£ç†ç»„ (Proxy Groups)
#----------------------------------------------------------------#
# å˜æ›´ç‚¹ 2ï¼šè°ƒæ•´ç­–ç•¥ç»„ä»¥æ”¯æŒåŒè®¢é˜…
proxy-groups:
  - name: ğŸš€ æµ·å¤–é€šç”¨
    type: select
    proxies:
      - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
      - ğŸ‘† æ‰‹åŠ¨åˆ‡æ¢
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
      - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
      - ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
      - ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹
      - ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹
      - DIRECT
  - name: ğŸŒ æµ·å¤–ç‰¹æ®Š
    type: select
    proxies:
      - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
      - ğŸ‘† æ‰‹åŠ¨åˆ‡æ¢
      - ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
      - ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹
      - ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹
      - DIRECT
  - name: ğŸ‘† æ‰‹åŠ¨åˆ‡æ¢
    # åŒæ—¶ä½¿ç”¨ä¸¤ä¸ªè®¢é˜…çš„æ‰€æœ‰èŠ‚ç‚¹
    use:
      - main_subscription
      - cloudflare_subscription
    type: select
  - name: â™»ï¸ è‡ªåŠ¨é€‰æ‹©
    type: url-test
    # å¯¹ä¸¤ä¸ªè®¢é˜…çš„æ‰€æœ‰èŠ‚ç‚¹è¿›è¡Œå»¶è¿Ÿæµ‹è¯•
    use:
      - main_subscription
      - cloudflare_subscription
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
  - name: ğŸ® æ¸¸æˆå¹³å°
    type: select
    proxies:
      - DIRECT
      - ğŸš€ æµ·å¤–é€šç”¨
      - ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
      - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
      - ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
      - ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹
      - ğŸ‘† æ‰‹åŠ¨åˆ‡æ¢
  - name: â˜ï¸ CFåˆ‡æ¢
    type: select
    proxies:
      - DIRECT
      - â˜ï¸ CloudflareèŠ‚ç‚¹
      - ğŸš€ æµ·å¤–é€šç”¨
      - ğŸ‘† æ‰‹åŠ¨åˆ‡æ¢
  - name: ğŸ¯ å…¨çƒç›´è¿
    type: select
    proxies:
      - DIRECT
      - ğŸš€ æµ·å¤–é€šç”¨
      - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
  - name: ğŸŸ æ¼ç½‘ä¹‹é±¼
    type: select
    proxies:
      - ğŸš€ æµ·å¤–é€šç”¨
      - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
      - DIRECT
      - ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
      - ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
      - ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
      - ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹
      - ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹
      - ğŸ‘† æ‰‹åŠ¨åˆ‡æ¢
  - name: ğŸ‡­ğŸ‡° é¦™æ¸¯èŠ‚ç‚¹
    # ä»ä¸»è®¢é˜…ä¸­ç­›é€‰
    use:
      - main_subscription
    filter: '(?i)æ¸¯|HK|hk|Hong Kong|HongKong|hongkong'
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
  - name: ğŸ‡¯ğŸ‡µ æ—¥æœ¬èŠ‚ç‚¹
    use:
      - main_subscription
    filter: '(?i)æ—¥æœ¬|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|æ²ªæ—¥|æ·±æ—¥|JP|Japan'
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
  - name: ğŸ‡ºğŸ‡² ç¾å›½èŠ‚ç‚¹
    use:
      - main_subscription
    filter: '(?i)ç¾|æ³¢ç‰¹å…°|è¾¾æ‹‰æ–¯|ä¿„å‹’å†ˆ|å‡¤å‡°åŸ|è´¹åˆ©è’™|ç¡…è°·|æ‹‰æ–¯ç»´åŠ æ–¯|æ´›æ‰çŸ¶|åœ£ä½•å¡|åœ£å…‹æ‹‰æ‹‰|è¥¿é›…å›¾|èŠåŠ å“¥|US|United States'
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
  - name: ğŸ‡¨ğŸ‡³ å°æ¹¾èŠ‚ç‚¹
    use:
      - main_subscription
    filter: '(?i)å°|æ–°åŒ—|å½°åŒ–|TW|Taiwan'
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
  - name: ğŸ‡¸ğŸ‡¬ ç‹®åŸèŠ‚ç‚¹
    use:
      - main_subscription
    filter: '(?i)æ–°åŠ å¡|å¡|ç‹®åŸ|SG|Singapore'
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
  - name: ğŸ‡°ğŸ‡· éŸ©å›½èŠ‚ç‚¹
    use:
      - main_subscription
    filter: '(?i)KR|Korea|KOR|é¦–å°”|éŸ©|éŸ“'
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
  - name: â˜ï¸ CloudflareèŠ‚ç‚¹
    # ç›´æ¥ä½¿ç”¨ä¸“ç”¨çš„ Cloudflare è®¢é˜…è¿›è¡Œæµ‹é€Ÿ
    use:
      - cloudflare_subscription
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50


# (7) è§„åˆ™æä¾›å•† (Rule Providers) - æ— éœ€æ”¹åŠ¨
#----------------------------------------------------------------#
rule-providers:
  my_ai:
    type: http
    behavior: classical
    url: "https://github.wanghy.top/github.com/hong123yuan/clashrule/blob/main/my%20rule/ai.yaml"
    path: ./ruleset/my_ai.yaml
    interval: 86400
  my_cloudflare:
    type: http
    behavior: classical
    url: "https://github.wanghy.top/github.com/hong123yuan/clashrule/blob/main/my%20rule/cloudflare.yaml"
    path: ./ruleset/my_cloudflare.yaml
    interval: 86400
  my_google_smart_devices:
    type: http
    behavior: classical
    url: "https://github.wanghy.top/github.com/hong123yuan/clashrule/blob/main/my%20rule/smart.yaml"
    path: ./ruleset/my_google_smart_devices.yaml
    interval: 86400
  tongyong:
    type: http
    behavior: classical
    url: "https://github.wanghy.top/github.com/hong123yuan/clashrule/blob/main/my%20rule/tongyong.yaml"
    path: ./ruleset/tongyong.yaml
    interval: 86400
  zhilian:
    type: http
    behavior: classical
    url: "https://github.wanghy.top/github.com/hong123yuan/clashrule/blob/main/my%20rule/zhilian.yaml"
    path: ./ruleset/zhilian.yaml
    interval: 86400
  LocalAreaNetwork:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/LocalAreaNetwork.list
    path: ./ruleset/LocalAreaNetwork.list
    behavior: classical
    interval: 86400
    format: text
    type: http
  GoogleFCM:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Ruleset/GoogleFCM.list
    path: ./ruleset/GoogleFCM.list
    behavior: classical
    interval: 86400
    format: text
    type: http
  SteamCN:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Ruleset/SteamCN.list
    path: ./ruleset/SteamCN.list
    behavior: classical
    interval: 86400
    format: text
    type: http
  Telegram:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Telegram.list
    path: ./ruleset/Telegram.list
    behavior: classical
    interval: 86400
    format: text
    type: http
  Steam:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Ruleset/Steam.list
    path: ./ruleset/Steam.list
    behavior: classical
    interval: 86400
    format: text
    type: http
  YouTube:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Ruleset/YouTube.list
    path: ./ruleset/YouTube.list
    behavior: classical
    interval: 86400
    format: text
    type: http
  ProxyMedia:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/ProxyMedia.list
    path: ./ruleset/ProxyMedia.list
    behavior: classical
    interval: 86400
    format: text
    type: http
  ProxyGFWlist:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/ProxyGFWlist.list
    path: ./ruleset/ProxyGFWlist.list
    behavior: classical
    interval: 86400
    format: text
    type: http
  ChinaDomain:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/ChinaDomain.list
    path: ./ruleset/ChinaDomain.list
    behavior: classical
    interval: 86400
    format: text
    type: http
  ChinaCompanyIp:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/ChinaCompanyIp.list
    path: ./ruleset/ChinaCompanyIp.list
    behavior: classical
    interval: 86400
    format: text
    type: http
  Download:
    url: https://testingcf.jsdelivr.net/gh/ACL4SSR/ACL4SSR@master/Clash/Download.list
    path: ./ruleset/Download.list
    behavior: classical
    interval: 86400
    format: text
    type: http
  cn_ip:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/meta/geo/geoip/cn.mrs
    path: ./ruleset/cn.mrs
    interval: 86400


# (8) è·¯ç”±è§„åˆ™ (Rules) - æ— éœ€æ”¹åŠ¨
#----------------------------------------------------------------#
rules:
  - "PROCESS-NAME,subs-check.exe,ğŸ¯ å…¨çƒç›´è¿"
  - "PROCESS-NAME,subs-check,ğŸ¯ å…¨çƒç›´è¿"
  - "RULE-SET,LocalAreaNetwork,ğŸ¯ å…¨çƒç›´è¿"
  - "RULE-SET,my_ai,ğŸŒ æµ·å¤–ç‰¹æ®Š"
  - "RULE-SET,my_cloudflare,â˜ï¸ CFåˆ‡æ¢"
  - "RULE-SET,my_google_smart_devices,ğŸš€ æµ·å¤–é€šç”¨"
  - "RULE-SET,tongyong,ğŸš€ æµ·å¤–é€šç”¨"
  - "RULE-SET,zhilian,ğŸ¯ å…¨çƒç›´è¿"
  - "RULE-SET,GoogleFCM,ğŸš€ æµ·å¤–é€šç”¨"
  - "RULE-SET,SteamCN,ğŸ¯ å…¨çƒç›´è¿"
  - "RULE-SET,Telegram,ğŸš€ æµ·å¤–é€šç”¨"
  - "RULE-SET,Steam,ğŸ® æ¸¸æˆå¹³å°"
  - "RULE-SET,YouTube,ğŸš€ æµ·å¤–é€šç”¨"
  - "RULE-SET,ProxyMedia,ğŸš€ æµ·å¤–é€šç”¨"
  - "RULE-SET,ProxyGFWlist,ğŸš€ æµ·å¤–é€šç”¨"
  - "RULE-SET,ChinaDomain,ğŸ¯ å…¨çƒç›´è¿"
  - "RULE-SET,ChinaCompanyIp,ğŸ¯ å…¨çƒç›´è¿"
  - "RULE-SET,Download,ğŸ¯ å…¨çƒç›´è¿"
  - "GEODATA,cn,ğŸ¯ å…¨çƒç›´è¿"
  - "MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼"
